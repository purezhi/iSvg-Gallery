iSvgGallery.app=function(d){var k=d.features,w=d.albums;var G="http://www.w3.org/2000/svg",x="http://www.w3.org/1999/xlink",t="body";galleryElId="canvas";albumIdPrefix="album",coverIdPrefix="cover",imageIdPrefix="image",listStyleGrid="grid",listStyleFree="free",opacityMaximum=1,opacityMiddle=0.5,opacityMinimum=0,nextAlbumId=0,nextImageId=0,relationAI={},imagesOnGallery=[],topImageOnGallery={},albumsOnGallery=[],topAlbumsOnGallery={},globalCache={},globalCache.tooltip={},globalCache.opacity={},globalCache.debug="",currentTransform=null,galleryMinWidth=1005,galleryMinHeight=618;
galleryViewWidth=document.documentElement.clientWidth<galleryMinWidth?galleryMinWidth:document.documentElement.clientWidth,galleryViewHeight=document.documentElement.clientHeight<galleryMinHeight?galleryMinHeight:document.documentElement.clientHeight;galleryWidth=galleryViewWidth,galleryHeight=galleryViewHeight,imgMinWidth=300,imgMinHeight=200,imgZoomMinWidth=250*galleryMinWidth/galleryWidth,imgZoomMinHeight=260*galleryMinHeight/galleryHeight,imgInitWRange=[imgZoomMinWidth,350*galleryMinWidth/galleryWidth],imgInitHRange=[imgZoomMinHeight,300*galleryMinHeight/galleryHeight],albumThumbBaseWidth=1000,albumThumbBaseHeight=700,albumThumbWidth=200,albumThumbHeight=140,albumThumbDiagonal=Math.sqrt(Math.pow(albumThumbWidth,2)+Math.pow(albumThumbHeight,2)),imageListStyle=listStyleFree,imageBorderRadius="20",imageBorderClass="imageBorder",imageBorderStrokeWidth="25",imageBorderStrokeWidthMin="16",imageDefaultOpacity=1,imageHoverOpacity=0.7,imageOverlayClass="imageOverlay",hotSpotClass="imageHotSpot",hotSpotFillColor="rgba(0, 200, 200, 0.3)",hotSpotStrokeColor="rgba(100, 100, 100, 0.5)",hotSpotSide=200,hotSpotSideMinimum=20,hotSpotRadius=30,topImageResizable=false,topImageExclusive=true,topImageBgOverlayId="top-img-background-overlay",albumListStyle=listStyleGrid,albumOpenedOpacity=0.5,albumClosedOpacity=0.3,coverBorderRadius="10",coverBorderClass="coverBorder",contextMenuId="ctxMenu",ctxMenuItemClass="ctxMenuItem",ctxMenuItemHoverClass="ctxMenuItemHover",ctxMenuItemTextClass="ctxMenuItemText",ctxMenuItemTextHoverClass="ctxMenuItemTextHover",ctxDividingLineClass="ctxDividingLine",tooltipBackgroundClass="tooltipBackground",tooltipTextClass="tooltipText";
function O(){q(w);c(k);document.getElementById(galleryElId).addEventListener("mousemove",b,false);document.getElementById(galleryElId).addEventListener("mouseup",Y,false);document.getElementById("background-rect").addEventListener("mousemove",b,false);document.getElementById("background-rect").addEventListener("mouseup",Y,false);
document.getElementById(galleryElId).addEventListener("contextmenu",function(ab){u(ab);ab.preventDefault()},false);document.getElementById(galleryElId).addEventListener("click",function(ab){var ac=document.getElementById(contextMenuId);if(ac){ac.parentNode.removeChild(ac)
}},true);window.addEventListener("resize",function(ab){J(document.documentElement.clientWidth,document.documentElement.clientHeight);ab.preventDefault()},false)}function q(af){var ad=Math.floor(galleryViewWidth/albumThumbDiagonal);var ac=Math.floor(galleryViewHeight/albumThumbWidth);
var ab;if(!(af instanceof Array)){ab=Z(albumListStyle,ad,ac,albumThumbDiagonal,albumThumbWidth,albumsOnGallery.length);if(albumListStyle==listStyleGrid&&ab.overflow){n(1,2);ab=Z(albumListStyle,ad,ac,albumThumbDiagonal,albumThumbWidth,albumsOnGallery.length)
}r(0,af,{translate:ab.translate,position:ab.position})}else{for(var ae=0;ae<af.length;ae++){ab=Z(albumListStyle,ad,ac,albumThumbDiagonal,albumThumbWidth,albumsOnGallery.length);if(albumListStyle==listStyleGrid&&ab.overflow){n(1,2);ab=Z(albumListStyle,ad,ac,albumThumbDiagonal,albumThumbWidth,albumsOnGallery.length)
}r(ae,af[ae],{translate:ab.translate,position:ab.position})}}}function r(af,ac,ab){if(!ac.id&&ac.id!=0){return}var ae=[];for(var ah=0;ah<ac.images.length;ah++){if(ah>2){break}ae.push(ac.images[ah])}if(ac.cover){ae.push(ac.cover)}var ad=nextAlbumId++;var ak=nextImageId;
c(ae,ab);var aj=nextImageId-1;var al=albumIdPrefix+ad;relationAI[al]={};relationAI[al].id=ac.id;relationAI[al].name=ac.name;relationAI[al].cover=ac.cover;relationAI[al].images=[];for(var ag=ak;ag<=aj;ag++){relationAI[al].images.push(coverIdPrefix+ag);relationAI[coverIdPrefix+ag]={};
relationAI[coverIdPrefix+ag].parent=al}var ai=document.createElementNS(G,"g");ai.setAttribute("id",al);ai.vTranslate=[0,0];ai.vScale=1;ai.vRotate=0;ai.addEventListener("mousedown",function(am){K(am,"c","move");am.preventDefault()},false);document.getElementById(galleryElId).appendChild(ai);
albumsOnGallery.push({id:al,position:ab.position})}function c(ab,ad){if(!(ab instanceof Array)){p(ab,ad)}else{for(var ac=0;ac<ab.length;ac++){p(ab[ac],ad)}}}function p(ad,ae){var ac=new Image();var ab=nextImageId++;ac.onload=function(ag,af){return function(){if(this.width<imgMinWidth||this.height<imgMinHeight){return
}if(ae){var ai=U(this,af,ag,opacityMaximum,ae)}else{var ai=o(this,af,ag,opacityMaximum)}if(!ai){return}else{if(topImageOnGallery.id){if(topImageExclusive){C(topImageBgOverlayId)}C(topImageOnGallery.id)}}if(ae){ai.vTranslate=ae.translate;ai.vScale=albumThumbWidth/albumThumbBaseWidth>albumThumbHeight/albumThumbBaseHeight?albumThumbHeight/albumThumbBaseHeight:albumThumbWidth/albumThumbBaseWidth
}else{var ah=Z(imageListStyle,4,3,galleryMinWidth/4,galleryMinHeight/3,imagesOnGallery.length,galleryViewWidth,galleryViewHeight);if(imageListStyle==listStyleGrid&&ah.overflow){n(1,2);ah=Z(imageListStyle,4,3,galleryMinWidth/4,galleryMinHeight/3,imagesOnGallery.length,galleryViewWidth,galleryViewHeight)
}ai.vTranslate=ah.translate;var aj=s(this.width,this.height);if(this.height>this.width){ai.vScale=aj.height[0]/this.height+Math.random()*((aj.height[1]-aj.height[0])/this.height)}else{ai.vScale=aj.width[0]/this.width+Math.random()*((aj.width[1]-aj.width[0])/this.width)
}imagesOnGallery.push({id:(imageIdPrefix+af),uri:this.src,position:ah.position})}ai.style.opacity=opacityMaximum;ai.vRotate=(Math.random()*40)-20;ai.vTranslate[0]=ai.vTranslate[0]>galleryViewWidth?(galleryViewWidth-albumThumbWidth/4):ai.vTranslate[0];ai.vTranslate[1]=ai.vTranslate[1]>galleryViewHeight?(galleryViewHeight-albumThumbHeight/4):ai.vTranslate[1];
z(ai.id);X(ai,imageDefaultOpacity)}}(ad,ab);ac.src=ad}function o(ab,ad,ac,ai){var am=imageIdPrefix+ad;var ah=document.createElementNS(G,"g");ah.setAttribute("id",am);ah.addEventListener("mouseover",e,false);ah.addEventListener("mouseout",g,false);ah.addEventListener("mousedown",function(an){m(an,"c","move");
an.preventDefault()},false);ah.addEventListener("dblclick",function(an){l(am);an.preventDefault()},false);if(ai!=null){ah.style.opacity=ai}var ae=document.createElementNS(G,"image");ae.setAttribute("id",am+"-img");A(ae,-ab.width/2,-ab.height/2,ab.width,ab.height);
ae.setAttribute("preserveAspectRatio","xMinYMin slice");ae.setAttributeNS(x,"href",ac);ah.appendChild(ae);var ak=document.createElementNS(G,"rect");ak.setAttribute("id",am+"-border");ak.setAttribute("class",imageBorderClass);A(ak,-ab.width/2,-ab.height/2,ab.width,ab.height);
ak.setAttribute("rx",imageBorderRadius);ak.setAttribute("ry",imageBorderRadius);var af=imageBorderStrokeWidth*ab.width/galleryMinWidth;af=af<imageBorderStrokeWidthMin?imageBorderStrokeWidthMin:af;ak.setAttribute("stroke-width",af);ah.appendChild(ak);var al=document.createElementNS(G,"g");
al.setAttribute("id",am+"-overlay");al.setAttribute("class",imageOverlayClass);al.setAttribute("style","visibility: hidden");var aj=ab.width>ab.height?ab.height:ab.width;var ag=aj/5>hotSpotSide?hotSpotSide:aj/5;ag=ag<hotSpotSideMinimum?hotSpotSideMinimum:ag;
al.appendChild(Q(am+"-tl",-ab.width/2,-ab.height/2,ag,ag,hotSpotFillColor,hotSpotStrokeColor,function(an){return m(an,"tl","rotate")},hotSpotClass));al.appendChild(Q(am+"-tr",ab.width/2-ag,-ab.height/2,ag,ag,hotSpotFillColor,hotSpotStrokeColor,function(an){return m(an,"tr","rotate")
},hotSpotClass));al.appendChild(Q(am+"-br",ab.width/2-ag,ab.height/2-ag,ag,ag,hotSpotFillColor,hotSpotStrokeColor,function(an){return m(an,"br","rotate")},hotSpotClass));al.appendChild(Q(am+"-bl",-ab.width/2,ab.height/2-ag,ag,ag,hotSpotFillColor,hotSpotStrokeColor,function(an){return m(an,"bl","rotate")
},hotSpotClass));ah.appendChild(al);document.getElementById(galleryElId).appendChild(ah);return ah}function U(ab,ad,ac,ai,ae){var ag=albumThumbBaseWidth;var ak=albumThumbBaseHeight;var al=coverIdPrefix+ad;var ah=document.createElementNS(G,"g");ah.setAttribute("id",al);
ah.addEventListener("mousedown",function(am){K(am,"c","move");am.preventDefault()},false);ah.addEventListener("mouseover",function(am){H(am);am.preventDefault()},false);ah.addEventListener("dblclick",function(am){F();T(al);am.preventDefault()},false);if(ai!=null){ah.style.opacity=ai
}var af=document.createElementNS(G,"image");af.setAttribute("id",al+"-img");A(af,-ag/2,-ak/2,ag,ak);if(f("webkit")){af.setAttribute("preserveAspectRatio","xMinYMin slice")}else{af.setAttribute("preserveAspectRatio","xMidYMid slice")}af.setAttributeNS(x,"href",ac);
ah.appendChild(af);var aj=document.createElementNS(G,"rect");aj.setAttribute("id",al+"-border");aj.setAttribute("class",coverBorderClass);A(aj,-ag/2,-ak/2,ag,ak);aj.setAttribute("rx",coverBorderRadius);aj.setAttribute("ry",coverBorderRadius);ah.appendChild(aj);
if(document.getElementById(R(al))){document.getElementById(R(al)).appendChild(ah)}return ah}function m(ae,ad,ag){if(currentTransform!=null){return}var af=P(ae);if(!af){return}C(af);var ac=document.getElementById(af);var ab=document.getElementById(af+"-img");
var ah=ab.width.baseVal.value>ab.height.baseVal.value?imgZoomMinWidth/ab.width.baseVal.value:imgZoomMinHeight/ab.height.baseVal.value;currentTransform={what:ag,el:af,corner:ad,g:ac,s:ac.vScale,sx:ah,r:ac.vRotate,t:ac.vTranslate,x:ae.clientX,y:ae.clientY};X(currentTransform.g,imageHoverOpacity)
}function K(ad,ac,af){if(currentTransform!=null){return}var ae=P(ad);if(!ae){return}if(ae.indexOf(albumIdPrefix)<0){ae=R(ae)}var ab=document.getElementById(ae);if(!ab){return}currentTransform={what:af,el:ae,corner:ac,g:ab,s:ab.vScale,sx:0,r:ab.vRotate,t:ab.vTranslate,x:ad.clientX,y:ad.clientY};
X(currentTransform.g,imageHoverOpacity)}function F(ac){if(topImageOnGallery.id){l(topImageOnGallery.id);topImageOnGallery={}}if(imagesOnGallery instanceof Array){while(imagesOnGallery.length>0){var ab=document.getElementById(imagesOnGallery.shift().id);if(ab){document.getElementById(galleryElId).removeChild(ab)
}}}if(topAlbumsOnGallery.id){y(topAlbumsOnGallery.id,false)}topAlbumsOnGallery={};j(false,ac)}function i(ab){if(imagesOnGallery instanceof Array){for(var ac=0;ac<imagesOnGallery.length;ac++){if(imagesOnGallery[ac].id==ab){return imagesOnGallery[ac]}}}}function e(ab){var ac=P(ab);
if(!ac){return}if(topImageOnGallery.id!=ac||(topImageResizable&&topImageOnGallery.id==ac)){document.getElementById(ac+"-overlay").style.visibility="visible"}ab.preventDefault()}function H(ac){var ad=P(ac);if(!ad){return}var ab=E(ad);if(ab&&ab.name){I(ac,ab.name,false,300000)
}ac.preventDefault()}function g(ab){var ac=P(ab);if(!ac){return}document.getElementById(ac+"-overlay").style.visibility="hidden";ab.preventDefault()}function Y(ad){var ab=P(ad);var ae;if(ab.indexOf(albumIdPrefix)==0){var ac=ab;var ae=document.getElementById(ab)
}else{if(ab.indexOf(coverIdPrefix)==0){var ac=R(ab);var ae=document.getElementById(ac)}}if(ae&&topAlbumsOnGallery.id&&topAlbumsOnGallery.id!=ac){X(ae,albumClosedOpacity,imageHoverOpacity);currentTransform=null;ad.preventDefault();return}else{if(ae&&topAlbumsOnGallery.id&&topAlbumsOnGallery.id==ac){X(ae,albumOpenedOpacity,imageHoverOpacity);
currentTransform=null;ad.preventDefault();return}}if(currentTransform){X(currentTransform.g,imageDefaultOpacity,imageHoverOpacity)}currentTransform=null;ad.preventDefault()}function b(am){if(globalCache&&globalCache.tooltip){for(var ah in globalCache.tooltip){if(P(am).indexOf(coverIdPrefix)==-1){clearTimeout(globalCache.tooltip[ah].func);
var ai=document.getElementById(globalCache.tooltip[ah].id);if(ai){ai.parentNode.removeChild(ai)}delete globalCache.tooltip[ah]}else{if(currentTransform){var ai=document.getElementById(globalCache.tooltip[ah].id);if(ai){ai.parentNode.removeChild(ai)}}}}}if(currentTransform==null){return
}var ak=am.clientX;var aj=am.clientY;var al=currentTransform.g.vTranslate;if(currentTransform.what=="rotate"){var ab=360/(2*Math.PI);var ad=Math.atan2(currentTransform.y-al[1],currentTransform.x-al[0])*ab;var an=Math.atan2(aj-al[1],ak-al[0])*ab;currentTransform.g.vRotate+=(an-ad);
var ag=Math.sqrt(Math.pow(currentTransform.y-al[1],2)+Math.pow(currentTransform.x-al[0],2));var ac=Math.sqrt(Math.pow(aj-al[1],2)+Math.pow(ak-al[0],2));var ae=currentTransform.g.vScale*(ac/ag);currentTransform.g.vScale=ae>currentTransform.sx?(ae>1?1:ae):currentTransform.sx
}else{if(currentTransform.what=="move"){var ao=am.clientX-currentTransform.x;var af=am.clientY-currentTransform.y;currentTransform.g.vTranslate=[al[0]+ao,al[1]+af]}}currentTransform.x=ak;currentTransform.y=aj;z(currentTransform.el);am.preventDefault()}function T(ad){if(ad.toString().indexOf(albumIdPrefix)==0){var ac=ad
}else{if(ad.toString().indexOf(coverIdPrefix)==0){var ac=R(ad)}else{var ac=albumIdPrefix+ad}}var ab=E(ac);c(ab.images);topAlbumsOnGallery.id=ac;y(ac,true);j(true,true,ac)}function v(ac,ad,ab,ae){topImageOnGallery.id=ac;topImageOnGallery.transform={};topImageOnGallery.transform.vTranslate=ad.vTranslate;
topImageOnGallery.transform.vScale=ad.vScale;topImageOnGallery.transform.styleOpacity=ad.style.opacity;topImageOnGallery.transform.vRotate=ad.vRotate;ad.vTranslate=[galleryViewWidth/2,galleryViewHeight/2];ad.vScale=1;ad.style.opacity=opacityMaximum;ad.vRotate=0;
if(ab){S(true,"dblclick",function(af){return function(){l(af)}}(ac));C(ac)}z(ad.id);X(ad,imageDefaultOpacity,imageHoverOpacity);if(!ae){document.getElementById(ac+"-overlay").style.visibility="hidden"}}function a(ac,ad,ab){ad.vTranslate=topImageOnGallery.transform.vTranslate;
ad.vScale=topImageOnGallery.transform.vScale;ad.style.opacity=topImageOnGallery.transform.styleOpacity;ad.vRotate=topImageOnGallery.transform.vRotate;z(ad.id);X(ad,imageDefaultOpacity);if(ab){topImageOnGallery={}}S(false)}function l(ac){if(ac.toString().indexOf(imageIdPrefix)==0){var ad=ac
}else{var ad=imageIdPrefix+ac}var ae=document.getElementById(ad);if(!ae){return}if(topImageOnGallery.id==ad){a(ad,ae,true)}else{if(topImageOnGallery.id&&topImageOnGallery.id!=ad){var ab=document.getElementById(topImageOnGallery.id);if(ab){a(topImageOnGallery.id,ab,false)
}v(ad,ae,topImageExclusive,topImageResizable)}else{v(ad,ae,topImageExclusive,topImageResizable)}}}function y(af,ab){if(af.toString().indexOf(albumIdPrefix)==0){var ac=af}else{var ac=albumIdPrefix+af}var ae=document.getElementById(ac);if(!ae){return}ae.removeAttribute("style");
ae.removeAttribute("opacity");if(ab){var ag=document.createElementNS(G,"animate");ag.setAttribute("id","topAlbumAniOpacity");ag.setAttribute("attributeType","CSS");ag.setAttribute("attributeName","opacity");ag.setAttribute("from",opacityMaximum);ag.setAttribute("to",albumOpenedOpacity);
ag.setAttribute("dur","1s");ag.setAttribute("repeatCount","indefinite");var ad=document.createElementNS(G,"animateMotion");ad.setAttribute("id","topAlbumAniMotion");ad.setAttribute("path","M 0 0 V 10 V 8 V 5 V 3  V0");ad.setAttribute("fill","freeze");ad.setAttribute("begin","0s");
ad.setAttribute("dur","1s");ad.setAttribute("repeatCount","indefinite");ae.appendChild(ag);ae.appendChild(ad)}else{var ag=document.getElementById("topAlbumAniOpacity");if(ag){ae.removeChild(ag)}var ad=document.getElementById("topAlbumAniMotion");if(ad){ae.removeChild(ad)
}}}function j(ab,ac,ag){if(ab&&ag){if(ag.toString().indexOf(albumIdPrefix)==0){var ae=ag}else{var ae=albumIdPrefix+ag}for(var ad=0;ad<albumsOnGallery.length;ad++){var af=document.getElementById(albumsOnGallery[ad].id);if(!af){return}if(albumsOnGallery[ad].id==ae){if(ac){X(af,imageDefaultOpacity)
}else{af.style.opacity=imageDefaultOpacity}}else{if(ac){X(af,albumClosedOpacity)}else{af.style.opacity=albumClosedOpacity}}}}else{if(ab){for(var ad=0;ad<albumsOnGallery.length;ad++){var af=document.getElementById(albumsOnGallery[ad].id);if(!af){return}if(ac){X(af,albumClosedOpacity)
}else{af.style.opacity=albumClosedOpacity}}}else{for(var ad=0;ad<albumsOnGallery.length;ad++){var af=document.getElementById(albumsOnGallery[ad].id);if(!af){return}if(ac){X(af,imageDefaultOpacity)}else{af.style.opacity=imageDefaultOpacity}}}}}function u(ac){var ag=document.getElementById(contextMenuId);
if(ag){ag.parentNode.removeChild(ag)}var ab=document.createElementNS(G,"g");ab.setAttribute("id",contextMenuId);var ae=0,ai=180,ad=23;itPosX=ac.clientX+2,itPosY=ac.clientY+2,itClct=[],itInfo={};var ah=ac.target;if(V(ah)){itInfo={};itInfo.type="1";itInfo.index=ae++;
itInfo.id=contextMenuId+"Item-1-"+itInfo.index;if(topImageOnGallery.id==P(ac)){itInfo.text="关闭查看"}else{itInfo.text="查看原图"}itInfo.posX=itPosX;itInfo.posY=itPosY+(ad*itInfo.index);itInfo.width=ai;itInfo.height=ad;itInfo.handler=function(aj){return function(){l(aj)
}}(P(ac));itClct[itInfo.index]=itInfo;itInfo={};itInfo.type="1";itInfo.index=ae++;itInfo.id=contextMenuId+"Item-1-"+itInfo.index;itInfo.text="在新窗口打开图片";itInfo.posX=itPosX;itInfo.posY=itPosY+(ad*itInfo.index);itInfo.width=ai;itInfo.height=ad;itInfo.handler=function(aj){return function(){window.open(i(aj).uri)
}}(P(ac));itClct[itInfo.index]=itInfo;itInfo={};itInfo.type="1";itInfo.index=ae++;itInfo.id=contextMenuId+"Item-1-"+itInfo.index;itInfo.text="查看图片信息";itInfo.posX=itPosX;itInfo.posY=itPosY+(ad*itInfo.index);itInfo.width=ai;itInfo.height=ad;itInfo.handler=function(aj){return function(){aa(i(aj).uri)
}}(P(ac));itClct[itInfo.index]=itInfo}if(W(ah)){itInfo={};itInfo.type="2";itInfo.index=ae++;itInfo.id=contextMenuId+"Item-2-"+itInfo.index;if(!topAlbumsOnGallery.id||topAlbumsOnGallery.id&&topAlbumsOnGallery.id!=R(P(ac))){itInfo.text="打开相册";itInfo.handler=function(aj){return function(){F();
T(aj)}}(P(ac))}else{if(topAlbumsOnGallery.id==R(P(ac))){itInfo.text="关闭相册";itInfo.handler=function(){F(true);topAlbumsOnGallery={}}}}itInfo.posX=itPosX;itInfo.posY=itPosY+(ad*itInfo.index);itInfo.width=ai;itInfo.height=ad;itClct[itInfo.index]=itInfo;itInfo={};
itInfo.type="2";itInfo.index=ae++;itInfo.id=contextMenuId+"Item-2-"+itInfo.index;itInfo.text="查看相册信息";itInfo.posX=itPosX;itInfo.posY=itPosY+(ad*itInfo.index);itInfo.width=ai;itInfo.height=ad;itInfo.handler=function(aj){return function(){D(aj)}}(P(ac));itClct[itInfo.index]=itInfo
}itInfo={};itInfo.type="0";itInfo.index=ae++;itInfo.id=contextMenuId+"Item-0-"+itInfo.index;itInfo.text="清空画廊";itInfo.posX=itPosX;itInfo.posY=itPosY+(ad*itInfo.index);itInfo.width=ai;itInfo.height=ad;itInfo.handler=function(){F()};itClct[itInfo.index]=itInfo;
itInfo={};itInfo.type="0";itInfo.index=ae++;itInfo.id=contextMenuId+"Item-0-"+itInfo.index;itInfo.text="重新加载";itInfo.posX=itPosX;itInfo.posY=itPosY+(ad*itInfo.index);itInfo.width=ai;itInfo.height=ad;itInfo.handler=function(){var aj=window.top;aj.location.reload()
};itClct[itInfo.index]=itInfo;itInfo={};itInfo.type="9";itInfo.index=ae++;itInfo.id=contextMenuId+"Item-9-"+itInfo.index;itInfo.text="关于";itInfo.posX=itPosX;itInfo.posY=itPosY+(ad*itInfo.index);itInfo.width=ai;itInfo.height=ad;itInfo.handler=function(){var aj=iSvgGallery.name+"\n";
aj+="Ver. "+iSvgGallery.version+"\n\n";aj+=iSvgGallery.update+"\n";aj+=iSvgGallery.site+"\n";alert(aj)};itClct[itInfo.index]=itInfo;if((itPosX+ai)>galleryViewWidth){for(var af=0;af<itClct.length;af++){itClct[af].posX=itPosX-ai}}if((itPosY+ad*itClct.length)>galleryViewHeight){for(var af=0;
af<itClct.length;af++){itClct[af].posY=itPosY-ad*(itClct.length-itClct[af].index)}}for(var af=0;af<itClct.length;af++){if(af>0&&itClct[af].type!=itClct[af-1].type){ab.appendChild(B(itClct[af].posX,itClct[af].posY,itClct[af].posX+ai,itClct[af].posY))}ab.appendChild(N(itClct[af].index,itClct[af].id,itClct[af].text,itClct[af].posX,itClct[af].posY,itClct[af].width,itClct[af].height,itClct[af].handler,itClct[af].link,itClct[af].target))
}document.getElementById(galleryElId).appendChild(ab)}function N(ac,ah,aj,ai,ag,ab,al,an,af,ad){var am=document.createElementNS(G,"g");am.setAttribute("id",ah);am.addEventListener("mouseover",function(ao){return function(){var ar=ao;var aq=document.getElementById(ar+"-border");
var ap=document.getElementById(ar+"-text");if(aq){aq.setAttribute("class",ctxMenuItemHoverClass)}if(ap){ap.setAttribute("class",ctxMenuItemTextHoverClass)}}}(ah),false);am.addEventListener("mouseout",function(ao){return function(){var ar=ao;var aq=document.getElementById(ar+"-border");
var ap=document.getElementById(ar+"-text");if(aq){aq.setAttribute("class",ctxMenuItemClass)}if(ap){ap.setAttribute("class",ctxMenuItemTextClass)}}}(ah),false);if(an){am.addEventListener("click",an,false)}var ae=document.createElementNS(G,"rect");ae.setAttribute("id",ah+"-border");
ae.setAttribute("class",ctxMenuItemClass);A(ae,ai,ag,ab,al);var ak=document.createElementNS(G,"text");ak.setAttribute("id",ah+"-text");ak.setAttribute("class",ctxMenuItemTextClass);A(ak,ai+5,ag+al-7,ab,al);aniM=document.createElementNS(G,"animateMotion");aniM.setAttribute("path","M "+(-(ai+5-ab))+" 0 H 0 0");
aniM.setAttribute("fill","freeze");aniM.setAttribute("begin",0.2*ac+"s");aniM.setAttribute("dur","2s");ak.appendChild(aniM);aniSV=document.createElementNS(G,"animate");aniSV.setAttribute("attributeType","CSS");aniSV.setAttribute("attributeName","opacity");aniSV.setAttribute("from","0.2");
aniSV.setAttribute("to",opacityMaximum);aniSV.setAttribute("begin",0.2*ac+"s");aniSV.setAttribute("dur","2s");ak.appendChild(aniSV);ak.appendChild(document.createTextNode(aj));if(!an&&af&&ad){itlink=document.createElementNS(G,"a");itlink.setAttribute("xlink:href",af);
itlink.setAttribute("href",af);itlink.setAttribute("target",ad);itlink.appendChild(ae);itlink.appendChild(ak);am.appendChild(itlink)}else{am.appendChild(ae);am.appendChild(ak)}return am}function B(ae,ag,ac,af){var ah=document.createElementNS(G,"line");ah.setAttribute("x1",ae);
ah.setAttribute("y1",ag);ah.setAttribute("x2",ac);ah.setAttribute("y2",af);ah.setAttribute("width",2);ah.setAttribute("class",ctxDividingLineClass);var ab=document.createElementNS(G,"animate");ab.setAttribute("attributeType","XML");ab.setAttribute("attributeName","x2");
ab.setAttribute("from",ae);ab.setAttribute("to",ac);ab.setAttribute("fill","freeze");ab.setAttribute("begin","0s");ab.setAttribute("dur","0.5s");ah.appendChild(ab);var ad=document.createElementNS(G,"animate");ad.setAttribute("attributeType","XML");ad.setAttribute("attributeName","y2");
ad.setAttribute("from",ag);ad.setAttribute("to",af);ad.setAttribute("fill","freeze");ad.setAttribute("begin","0s");ad.setAttribute("dur","0.5s");ah.appendChild(ad);return ah}function D(ab){var ae=R(ab);var ac=E(ae);if(!ac){return}var ad="该相册的信息如下：\n\n";ad+="名称:        "+ac.name+"\n";
ad+="共包含 "+ac.images.length+" 张图片。\n\n";if(topAlbumsOnGallery.id==ae){ad+="相册当前处于打开状态。关闭它？";if(confirm(ad)){F(true);topAlbumsOnGallery={}}}else{ad+="您要打开这个相册吗？";if(confirm(ad)){F();T(ae)}}}function V(ab){if(ab.id.indexOf(imageIdPrefix)==0){return true}else{return false
}}function W(ab){if(ab.id.indexOf(coverIdPrefix)==0){return true}else{return false}}function z(ac){var ad=document.getElementById(ac);var ab=document.getElementById(ac+"-overlay");ad.setAttribute("transform","translate("+ad.vTranslate[0]+","+ad.vTranslate[1]+") scale("+ad.vScale+","+ad.vScale+") rotate("+ad.vRotate+") ")
}function Z(ab,am,ad,al,af,an,ak,ai){var ae,ac;var ah,ag;ah=Math.floor(an%am);ag=Math.floor(an/am);if(ab==listStyleGrid){ae=al/2*(2*ah+1);ac=af/2*(2*ag+1)}else{if(ab==listStyleFree){if(ak){ae=100+Math.random()*(ak-100)}else{ae=100+Math.random()*200+((an+1)%3)*250
}if(ai){ac=70+Math.random()*(ai-70)}else{ac=100+Math.random()*200+((an+1)/3)*280}}else{ae=100+Math.random()*300+((an+1)%3)*250;ac=100+Math.random()*300+((an+1)/3)*280}}var aj=((ah+1)*(ag+1))>(am*ad);return{translate:[ae,ac],position:[ah,ag],overflow:aj}}function J(ab,ac){galleryViewWidth=ab<galleryMinWidth?galleryMinWidth:ab;
galleryViewHeight=ac<galleryMinHeight?galleryMinHeight:ac}function n(ac,ae){galleryWidth=ac<galleryViewWidth?galleryViewWidth:ac;galleryHeight=ae<galleryViewHeight?galleryViewHeight:ae;var ad=document.getElementById(t);var ab=document.getElementById(galleryElId);
if(ad){ad.style.overflow="auto"}if(ab){ab.style.width=galleryWidth}ab.style.height=galleryHeight;alert("当前采用方格式排列方式，画廊没地儿了啦。")}function s(ab,ad){var ac=imgInitWRange,ae=imgInitHRange;if(galleryViewWidth/galleryMinWidth>1){ac=[imgInitWRange[0]*galleryViewWidth/galleryMinWidth,imgInitWRange[1]*galleryViewWidth/galleryMinWidth]
}if(galleryViewHeight/galleryMinHeight>1){ae=[imgInitHRange[0]*galleryViewHeight/galleryMinHeight,imgInitHRange[1]*galleryViewHeight/galleryMinHeight]}if(ab>ac[0]&&ab<ac[1]){ac[1]=ab}if(ab<=ac[0]){ac[0]=ac[1]=ab}if(ad>ae[0]&&ad<ae[1]){ae[1]=ad}if(ad<=ae[0]){ae[0]=ae[1]=ad
}return{width:ac,height:ae}}function Q(ac,af,ae,ag,ad,ah,ai,aj,ak){var ab=document.createElementNS(G,"rect");ab.setAttribute("id",ac);A(ab,af,ae,ag,ad);ab.setAttribute("rx",hotSpotRadius*ag/hotSpotSide);ab.setAttribute("ry",hotSpotRadius*ad/hotSpotSide);if(ak){ab.setAttribute("class",ak)
}else{ab.setAttribute("fill",ah)}ab.addEventListener("mousedown",aj,false);return ab}function S(ad,ab,ae){var ac=topImageBgOverlayId;if(!ad){var af=document.getElementById(ac);if(af){af.parentNode.removeChild(af)}return}var af=document.createElementNS(G,"rect");
af.setAttribute("id",ac);A(af,0,0,"100%","100%");af.setAttribute("fill","black");af.setAttribute("opacity","0.8");af.setAttribute("visibility","visible");if(ab&&ae){af.addEventListener(ab,ae,false)}document.getElementById(galleryElId).appendChild(af);C(ac)}function I(an,ax,ap,af){var ai=P(an);
var ag=R(ai);var au=ag+"-tooltip";var aB=ag+"-tooltip-function";if(document.getElementById(au)||(!ap&&globalCache.tooltip[aB])){return}if(!ap){globalCache.tooltip[aB]={};globalCache.tooltip[aB].src=ag;globalCache.tooltip[aB].id=au;globalCache.tooltip[aB].func=setTimeout(function(){return function(){I(an,ax,true,af)
}}(an,ax,true,af),1022);return}var ac=document.createElementNS(G,"g");ac.setAttribute("id",au);var az=document.getElementById(ai);var ar=document.getElementById(ag);var ao=0,al=0;if(az&&ar&&az.vTranslate&&ar.vTranslate){ao=az.vTranslate[0]+ar.vTranslate[0];
al=az.vTranslate[1]+ar.vTranslate[1]}if(ao<=0||al<=0||ao>galleryWidth||al>galleryHeight){ao=an.clientX;al=an.clientY}var aq=20,ab=20,ah=50,av=20,aA=35,am=100,ae=10,ay="",ad=[],at=[];ay=ao+","+al+" "+(ao+ab)+","+(al-aq)+" "+(ao+ah)+","+(al-aq);ad=[ao-av,al-aq-aA];
at=[ao-av+ae,al-aq-ae];if((ad[0]+am)>galleryWidth&&ad[1]>=0){ay=ao+","+al+" "+(ao-ab)+","+(al-aq)+" "+(ao-ah)+","+(al-aq);ad=[ao+av-am,al-aq-aA];at=[ao+av-am+ae,al-aq-ae]}else{if((ad[0]+am)<=galleryWidth&&ad[1]<0){ay=ao+","+al+" "+(ao+ab)+","+(al+aq)+" "+(ao+ah)+","+(al+aq);
ad=[ao-av,al+aq];at=[ao-av+ae,al+aq+aA-ae]}else{if((ad[0]+am)>galleryWidth&&ad[1]<0){ay=ao+","+al+" "+(ao-ab)+","+(al+aq)+" "+(ao-ah)+","+(al+aq);ad=[ao+av-am,al+aq];at=[ao+av-am+ae,al+aq+aA-ae]}}}var aw=document.createElementNS(G,"polygon");aw.setAttribute("id",au+"-triangleBg");
aw.setAttribute("class",tooltipBackgroundClass);aw.setAttribute("points",ay);ac.appendChild(aw);var aj=document.createElementNS(G,"rect");aj.setAttribute("id",au+"-rectBg");aj.setAttribute("class",tooltipBackgroundClass);aj.setAttribute("rx",10);aj.setAttribute("ry",10);
A(aj,ad[0],ad[1],am,aA);ac.appendChild(aj);var ak=document.createElementNS(G,"text");ak.setAttribute("id",au+"-text");ak.setAttribute("class",tooltipTextClass);ak.appendChild(document.createTextNode(ax));A(ak,at[0],at[1],am,aA);ac.appendChild(ak);document.getElementById(galleryElId).appendChild(ac);
setTimeout(function(){document.getElementById(galleryElId).removeChild(ac);delete globalCache.tooltip[aB]},(af?af:3000));C(au)}function A(ae,ab,af,ac,ad){ae.setAttribute("x",ab);ae.setAttribute("y",af);ae.setAttribute("width",ac);ae.setAttribute("height",ad)
}function C(ac){var ab=document.getElementById(ac);ab.parentNode.removeChild(ab);document.getElementById(galleryElId).appendChild(ab)}function X(ad,af,ac){if(!ad){return}var ab=ad.id+"-function";if(globalCache.opacity[ab]){clearTimeout(globalCache.opacity[ab].func)
}else{globalCache.opacity[ab]={};globalCache.opacity[ab].id=ad.id}ad.style.opacity=(ac||ac==0)?parseFloat(ac):((ad.style.opacity||ad.style.opacity==0)?parseFloat(ad.style.opacity):1);var ae=parseFloat(ad.style.opacity);fd=parseFloat(af);if(ae<fd){M(ad,fd)}else{if(ae>fd){h(ad,fd)
}}}function h(ad,ac){if(!ad){return}if(parseFloat(ad.style.opacity)<=parseFloat(ac)){return}ad.removeAttribute("opacity");var ab=ad.id+"-function";var ae=function(){var af=parseFloat(ad.style.opacity)-0.05;ad.style.opacity=af;if(af>parseFloat(ac)){globalCache.opacity[ab].func=setTimeout(ae,10)
}else{delete globalCache.opacity[ab]}};ae()}function M(ad,ac){if(!ad){return}if(parseFloat(ad.style.opacity)>=parseFloat(ac)){return}ad.removeAttribute("opacity");var ab=ad.id+"-function";var ae=function(){var af=parseFloat(ad.style.opacity)+0.05;ad.style.opacity=af;
if(af<parseFloat(ac)){globalCache.opacity[ab].func=setTimeout(ae,10)}else{delete globalCache.opacity[ab]}};ae()}function L(){var ab=document.createElementNS(G,"defs");var ac=document.createElementNS(G,"filter");ac.setAttribute("id","gaussianBlur");var ad=document.createElementNS(G,"feGaussianBlur");
ac.setAttribute("in","SourceGraphic");ac.setAttribute("stdDeviation","20");ac.appendChild(ad);ab.appendChild(ac);document.getElementById(galleryElId).appendChild(ab)}function R(ab){if(relationAI&&(ab in relationAI)){return relationAI[ab].parent}return null}function E(ae){if(ae.indexOf(albumIdPrefix)==0){var ac=ae
}else{var ac=R(ae)}if(!ac){return}if(!(relationAI[ac]&&(relationAI[ac].id||relationAI[ac].id==0))){return}var ad;if(!(w instanceof Array)){ad=w}else{for(var ab=0;ab<w.length;ab++){if(w[ab].id==relationAI[ac].id){ad=w[ab];break}}}return ad}function P(ab){var ac=ab.target.getAttribute("id");
return ac.substr(0,ac.indexOf("-"))}function aa(ac){var ab=new Image();ab.onload=function(){var ad="该图片的信息如下：\n\n";ad+="文件:        "+this.src.substr(this.src.lastIndexOf("/")+1,this.src.length)+"图片\n";ad+="类型:        "+this.src.substr(this.src.lastIndexOf(".")+1,this.src.length).toUpperCase()+"图片\n";
ad+="大小:        未知\n";ad+="尺寸:        "+this.width+"px × "+this.height+"px\n";ad+="地址:        "+this.src+"\n\n";ad+="您要在新窗口打开图片吗？";if(confirm(ad)){window.open(this.src)}};ab.src=ac}function f(ae){var af=/(webkit)[ \/]([\w.]+)/;var ai=/(opera)(?:.*version)?[ \/]([\w.]+)/;
var ad=/(msie) ([\w.]+)/;var ah=/(mozilla)(?:.*? rv:([\w.]+))?/;var ag=navigator.userAgent;ag=ag.toLowerCase();var ac=af.exec(ag)||ai.exec(ag)||ad.exec(ag)||ag.indexOf("compatible")<0&&ah.exec(ag)||[];var ab={browser:ac[1]||"",version:ac[2]||"0"};if(ab.browser==ae.toLowerCase()){return ab
}else{return false}}return O}(iSvgGallery.data);