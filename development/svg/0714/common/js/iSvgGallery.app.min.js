iSvgGallery.app=function(d){var k=d.features,w=d.albums;var F="http://www.w3.org/2000/svg",x="http://www.w3.org/1999/xlink",t="body";galleryElId="canvas";albumIdPrefix="album",coverIdPrefix="cover",imageIdPrefix="image",listStyleGrid="grid",listStyleFree="free",opacityMaximum=1,opacityMiddle=0.5,opacityMinimum=0,nextAlbumId=0,nextImageId=0,relationAI={},imagesOnGallery=[],topImageOnGallery={},albumsOnGallery=[],topAlbumsOnGallery={},contextMenuId="ctxMenu",globalCache={},globalCache.tooltip={},globalCache.debug="",currentTransform=null,galleryMinWidth=1005,galleryMinHeight=618;
galleryViewWidth=document.documentElement.clientWidth<galleryMinWidth?galleryMinWidth:document.documentElement.clientWidth,galleryViewHeight=document.documentElement.clientHeight<galleryMinHeight?galleryMinHeight:document.documentElement.clientHeight;galleryWidth=galleryViewWidth,galleryHeight=galleryViewHeight,imgMinWidth=300,imgMinHeight=200,imgZoomMinWidth=320,imgZoomMinHeight=280,imgInitWRange=[imgZoomMinWidth,350],imgInitHRange=[imgZoomMinHeight,300],albumThumbBaseWidth=1000,albumThumbBaseHeight=700,albumThumbWidth=200,albumThumbHeight=140,albumThumbDiagonal=Math.sqrt(Math.pow(albumThumbWidth,2)+Math.pow(albumThumbHeight,2)),imageListStyle=listStyleFree,imageBorderRadius="10",imageBorderStroke="black",imageBorderStrokeWidth="18",imageBorderStrokeOpacity=1,imageDefaultOpacity=1,imageHoverOpacity=0.7,hotSpotFillColor="rgba(0, 200, 200, 0.3)",hotSpotStrokeColor="rgba(100, 100, 100, 0.5)",hotSpotSide=200,topImageResizable=false,topImageExclusive=true,albumListStyle=listStyleGrid,albumOpenedOpacity=0.5,albumClosedOpacity=0.3,coverBorderRadius="10",coverBorderStroke="grey",coverBorderStrokeWidth="30",coverBorderStrokeOpacity=0.6;
function M(){q(w);c(k);document.getElementById(galleryElId).addEventListener("mousemove",b,false);document.getElementById(galleryElId).addEventListener("mouseup",W,false);document.getElementById("background-rect").addEventListener("mousemove",b,false);document.getElementById("background-rect").addEventListener("mouseup",W,false);
document.getElementById(galleryElId).addEventListener("contextmenu",function(Z){u(Z);Z.preventDefault()},false);document.getElementById(galleryElId).addEventListener("click",function(Z){var aa=document.getElementById(contextMenuId);if(aa){aa.parentNode.removeChild(aa)
}},true);window.addEventListener("resize",function(Z){I(document.documentElement.clientWidth,document.documentElement.clientHeight);Z.preventDefault()},false)}function q(ad){var ab=Math.floor(galleryViewWidth/albumThumbDiagonal);var aa=Math.floor(galleryViewHeight/albumThumbWidth);
var Z;if(!(ad instanceof Array)){Z=X(albumListStyle,ab,aa,albumThumbDiagonal,albumThumbWidth,albumsOnGallery.length);if(albumListStyle==listStyleGrid&&Z.overflow){n(1,2);Z=X(albumListStyle,ab,aa,albumThumbDiagonal,albumThumbWidth,albumsOnGallery.length)}r(0,ad,{translate:Z.translate,position:Z.position})
}else{for(var ac=0;ac<ad.length;ac++){Z=X(albumListStyle,ab,aa,albumThumbDiagonal,albumThumbWidth,albumsOnGallery.length);if(albumListStyle==listStyleGrid&&Z.overflow){n(1,2);Z=X(albumListStyle,ab,aa,albumThumbDiagonal,albumThumbWidth,albumsOnGallery.length)
}r(ac,ad[ac],{translate:Z.translate,position:Z.position})}}}function r(ad,aa,Z){if(!aa.id&&aa.id!=0){return}var ac=[];for(var af=0;af<aa.images.length;af++){if(af>2){break}ac.push(aa.images[af])}if(aa.cover){ac.push(aa.cover)}var ab=nextAlbumId++;var ai=nextImageId;
c(ac,Z);var ah=nextImageId-1;var aj=albumIdPrefix+ab;relationAI[aj]={};relationAI[aj].id=aa.id;relationAI[aj].name=aa.name;relationAI[aj].cover=aa.cover;relationAI[aj].images=[];for(var ae=ai;ae<=ah;ae++){relationAI[aj].images.push(coverIdPrefix+ae);relationAI[coverIdPrefix+ae]={};
relationAI[coverIdPrefix+ae].parent=aj}var ag=document.createElementNS(F,"g");ag.setAttribute("id",aj);ag.vTranslate=[0,0];ag.vScale=1;ag.vRotate=0;ag.addEventListener("mousedown",function(ak){J(ak,"c","move");ak.preventDefault()},false);document.getElementById(galleryElId).appendChild(ag);
albumsOnGallery.push({id:aj,position:Z.position})}function c(Z,ab){if(!(Z instanceof Array)){p(Z,ab)}else{for(var aa=0;aa<Z.length;aa++){p(Z[aa],ab)}}}function p(ab,ac){var aa=new Image();var Z=nextImageId++;aa.onload=function(ae,ad){return function(){if(this.width<imgMinWidth||this.height<imgMinHeight){return
}if(ac){var ag=S(this,ad,ae,opacityMaximum,ac)}else{var ag=o(this,ad,ae,opacityMaximum)}if(!ag){return}if(ac){ag.vTranslate=ac.translate;ag.vScale=albumThumbWidth/albumThumbBaseWidth>albumThumbHeight/albumThumbBaseHeight?albumThumbHeight/albumThumbBaseHeight:albumThumbWidth/albumThumbBaseWidth
}else{var af=X(imageListStyle,4,3,galleryMinWidth/4,galleryMinHeight/3,imagesOnGallery.length,galleryViewWidth,galleryViewHeight);if(imageListStyle==listStyleGrid&&af.overflow){n(1,2);af=X(imageListStyle,4,3,galleryMinWidth/4,galleryMinHeight/3,imagesOnGallery.length,galleryViewWidth,galleryViewHeight)
}ag.vTranslate=af.translate;var ah=s(this.width,this.height);if(this.height>this.width){ag.vScale=ah.height[0]/this.height+Math.random()*((ah.height[1]-ah.height[0])/this.height)}else{ag.vScale=ah.width[0]/this.width+Math.random()*((ah.width[1]-ah.width[0])/this.width)
}imagesOnGallery.push({id:(imageIdPrefix+ad),uri:this.src,position:af.position})}ag.style.opacity=opacityMaximum;ag.vRotate=(Math.random()*40)-20;ag.vTranslate[0]=ag.vTranslate[0]>galleryViewWidth?(galleryViewWidth-albumThumbWidth/4):ag.vTranslate[0];ag.vTranslate[1]=ag.vTranslate[1]>galleryViewHeight?(galleryViewHeight-albumThumbHeight/4):ag.vTranslate[1];
z(ag.id);V(ag,imageDefaultOpacity)}}(ab,Z);aa.src=ab}function o(Z,ab,aa,af){var ai=imageIdPrefix+ab;var ae=document.createElementNS(F,"g");ae.setAttribute("id",ai);ae.addEventListener("mouseover",e,false);ae.addEventListener("mouseout",g,false);ae.addEventListener("mousedown",function(aj){m(aj,"c","move");
aj.preventDefault()},false);ae.addEventListener("dblclick",function(aj){l(ai);aj.preventDefault()},false);if(af!=null){ae.style.opacity=af}var ac=document.createElementNS(F,"image");ac.setAttribute("id",ai+"-img");A(ac,-Z.width/2,-Z.height/2,Z.width,Z.height);
ac.setAttribute("preserveAspectRatio","xMinYMin slice");ac.setAttributeNS(x,"href",aa);ae.appendChild(ac);var ag=document.createElementNS(F,"rect");ag.setAttribute("id",ai+"-border");A(ag,-Z.width/2,-Z.height/2,Z.width,Z.height);ag.setAttribute("rx",imageBorderRadius);
ag.setAttribute("ry",imageBorderRadius);ag.setAttribute("stroke",imageBorderStroke);ag.setAttribute("stroke-width",imageBorderStrokeWidth);ag.setAttribute("stroke-opacity",imageBorderStrokeOpacity);ag.setAttribute("fill","none");ae.appendChild(ag);var ah=document.createElementNS(F,"g");
ah.setAttribute("id",ai+"-overlay");ah.setAttribute("class","image-overlay");ah.setAttribute("style","visibility: hidden");var ad=(Z.width/2-60)<hotSpotSide?(Z.width/2-50):hotSpotSide;ad=(Z.height/2-60)<ad?(Z.height/2-50):ad;ad=ad<20?20:ad;ah.appendChild(O(ai+"-tl",-Z.width/2,-Z.height/2,ad,ad,hotSpotFillColor,hotSpotStrokeColor,function(aj){return m(aj,"tl","rotate")
}));ah.appendChild(O(ai+"-tr",Z.width/2-ad,-Z.height/2,ad,ad,hotSpotFillColor,hotSpotStrokeColor,function(aj){return m(aj,"tr","rotate")}));ah.appendChild(O(ai+"-br",Z.width/2-ad,Z.height/2-ad,ad,ad,hotSpotFillColor,hotSpotStrokeColor,function(aj){return m(aj,"br","rotate")
}));ah.appendChild(O(ai+"-bl",-Z.width/2,Z.height/2-ad,ad,ad,hotSpotFillColor,hotSpotStrokeColor,function(aj){return m(aj,"bl","rotate")}));ae.appendChild(ah);document.getElementById(galleryElId).appendChild(ae);return ae}function S(Z,ab,aa,ag,ac){var ae=albumThumbBaseWidth;
var ai=albumThumbBaseHeight;var aj=coverIdPrefix+ab;var af=document.createElementNS(F,"g");af.setAttribute("id",aj);af.addEventListener("mousedown",function(ak){J(ak,"c","move");ak.preventDefault()},false);af.addEventListener("mouseover",function(ak){G(ak);
ak.preventDefault()},false);af.addEventListener("dblclick",function(ak){E();R(aj);ak.preventDefault()},false);if(ag!=null){af.style.opacity=ag}var ad=document.createElementNS(F,"image");ad.setAttribute("id",aj+"-img");A(ad,-ae/2,-ai/2,ae,ai);if(f("webkit")){ad.setAttribute("preserveAspectRatio","xMinYMin slice")
}else{ad.setAttribute("preserveAspectRatio","xMidYMid slice")}ad.setAttributeNS(x,"href",aa);af.appendChild(ad);var ah=document.createElementNS(F,"rect");ah.setAttribute("id",aj+"-border");A(ah,-ae/2,-ai/2,ae,ai);ah.setAttribute("stroke",coverBorderStroke);
ah.setAttribute("rx",coverBorderRadius);ah.setAttribute("ry",coverBorderRadius);ah.setAttribute("stroke-width",coverBorderStrokeWidth);ah.setAttribute("stroke-opacity",coverBorderStrokeOpacity);ah.setAttribute("fill","none");af.appendChild(ah);if(document.getElementById(P(aj))){document.getElementById(P(aj)).appendChild(af)
}return af}function m(ac,ab,ae){if(currentTransform!=null){return}var ad=N(ac);if(!ad){return}C(ad);var aa=document.getElementById(ad);var Z=document.getElementById(ad+"-img");var af=Z.width.baseVal.value>Z.height.baseVal.value?imgZoomMinWidth/Z.width.baseVal.value:imgZoomMinHeight/Z.height.baseVal.value;
currentTransform={what:ae,el:ad,corner:ab,g:aa,s:aa.vScale,sx:af,r:aa.vRotate,t:aa.vTranslate,x:ac.clientX,y:ac.clientY};V(currentTransform.g,imageHoverOpacity)}function J(ab,aa,ad){if(currentTransform!=null){return}var ac=N(ab);if(!ac){return}if(ac.indexOf(albumIdPrefix)<0){ac=P(ac)
}var Z=document.getElementById(ac);if(!Z){return}currentTransform={what:ad,el:ac,corner:aa,g:Z,s:Z.vScale,sx:0,r:Z.vRotate,t:Z.vTranslate,x:ab.clientX,y:ab.clientY};V(currentTransform.g,imageHoverOpacity)}function E(aa){if(topImageOnGallery.id){l(topImageOnGallery.id);
topImageOnGallery={}}if(imagesOnGallery instanceof Array){while(imagesOnGallery.length>0){var Z=document.getElementById(imagesOnGallery.shift().id);if(Z){document.getElementById(galleryElId).removeChild(Z)}}}if(topAlbumsOnGallery.id){y(topAlbumsOnGallery.id,false)
}topAlbumsOnGallery={};j(false,aa)}function i(Z){if(imagesOnGallery instanceof Array){for(var aa=0;aa<imagesOnGallery.length;aa++){if(imagesOnGallery[aa].id==Z){return imagesOnGallery[aa]}}}}function e(Z){var aa=N(Z);if(!aa){return}if(topImageOnGallery.id!=aa||(topImageResizable&&topImageOnGallery.id==aa)){document.getElementById(aa+"-overlay").style.visibility="visible"
}Z.preventDefault()}function G(aa){var ab=N(aa);if(!ab){return}var Z=D(ab);if(Z&&Z.name){H(aa,Z.name,false,30000)}aa.preventDefault()}function g(Z){var aa=N(Z);if(!aa){return}document.getElementById(aa+"-overlay").style.visibility="hidden";Z.preventDefault()
}function W(ab){var Z=N(ab);var ac;if(Z.indexOf(albumIdPrefix)==0){var aa=Z;var ac=document.getElementById(Z)}else{if(Z.indexOf(coverIdPrefix)==0){var aa=P(Z);var ac=document.getElementById(aa)}}if(ac&&topAlbumsOnGallery.id&&topAlbumsOnGallery.id!=aa){V(ac,albumClosedOpacity,imageHoverOpacity);
currentTransform=null;ab.preventDefault();return}else{if(ac&&topAlbumsOnGallery.id&&topAlbumsOnGallery.id==aa){V(ac,albumOpenedOpacity,imageHoverOpacity);currentTransform=null;ab.preventDefault();return}}if(currentTransform){V(currentTransform.g,imageDefaultOpacity,imageHoverOpacity)
}currentTransform=null;ab.preventDefault()}function b(ak){if(N(ak).indexOf(coverIdPrefix)==-1&&globalCache&&globalCache.tooltip){for(var af in globalCache.tooltip){clearTimeout(globalCache.tooltip[af].func)}globalCache.tooltip={}}if(N(ak).indexOf(coverIdPrefix)==0&&globalCache&&globalCache.tooltip){for(var af in globalCache.tooltip){var ag=document.getElementById(globalCache.tooltip[af].id);
if(currentTransform&&globalCache.tooltip[af].src==P(N(ak))&&ag){ag.parentNode.removeChild(ag)}}}if(currentTransform==null){return}var ai=ak.clientX;var ah=ak.clientY;var aj=currentTransform.g.vTranslate;if(currentTransform.what=="rotate"){var Z=360/(2*Math.PI);
var ab=Math.atan2(currentTransform.y-aj[1],currentTransform.x-aj[0])*Z;var al=Math.atan2(ah-aj[1],ai-aj[0])*Z;currentTransform.g.vRotate+=(al-ab);var ae=Math.sqrt(Math.pow(currentTransform.y-aj[1],2)+Math.pow(currentTransform.x-aj[0],2));var aa=Math.sqrt(Math.pow(ah-aj[1],2)+Math.pow(ai-aj[0],2));
var ac=currentTransform.g.vScale*(aa/ae);currentTransform.g.vScale=ac>currentTransform.sx?(ac>1?1:ac):currentTransform.sx}else{if(currentTransform.what=="move"){var am=ak.clientX-currentTransform.x;var ad=ak.clientY-currentTransform.y;currentTransform.g.vTranslate=[aj[0]+am,aj[1]+ad]
}}currentTransform.x=ai;currentTransform.y=ah;z(currentTransform.el);ak.preventDefault()}function R(ab){if(ab.toString().indexOf(albumIdPrefix)==0){var aa=ab}else{if(ab.toString().indexOf(coverIdPrefix)==0){var aa=P(ab)}else{var aa=albumIdPrefix+ab}}var Z=D(aa);
c(Z.images);topAlbumsOnGallery.id=aa;y(aa,true);j(true,true,aa)}function v(aa,ab,Z,ac){topImageOnGallery.id=aa;topImageOnGallery.transform={};topImageOnGallery.transform.vTranslate=ab.vTranslate;topImageOnGallery.transform.vScale=ab.vScale;topImageOnGallery.transform.styleOpacity=ab.style.opacity;
topImageOnGallery.transform.vRotate=ab.vRotate;ab.vTranslate=[galleryViewWidth/2,galleryViewHeight/2];ab.vScale=1;ab.style.opacity=opacityMaximum;ab.vRotate=0;if(Z){Q(true,"dblclick",function(ad){return function(){l(ad)}}(aa));C(aa)}z(ab.id);V(ab,imageDefaultOpacity);
if(!ac){document.getElementById(aa+"-overlay").style.visibility="hidden"}}function a(aa,ab,Z){ab.vTranslate=topImageOnGallery.transform.vTranslate;ab.vScale=topImageOnGallery.transform.vScale;ab.style.opacity=topImageOnGallery.transform.styleOpacity;ab.vRotate=topImageOnGallery.transform.vRotate;
z(ab.id);V(ab,imageDefaultOpacity);if(Z){topImageOnGallery={}}Q(false)}function l(aa){if(aa.toString().indexOf(imageIdPrefix)==0){var ab=aa}else{var ab=imageIdPrefix+aa}var ac=document.getElementById(ab);if(!ac){return}if(topImageOnGallery.id==ab){a(ab,ac,true)
}else{if(topImageOnGallery.id&&topImageOnGallery.id!=ab){var Z=document.getElementById(topImageOnGallery.id);if(Z){a(topImageOnGallery.id,Z,false)}v(ab,ac,topImageExclusive,topImageResizable)}else{v(ab,ac,topImageExclusive,topImageResizable)}}}function y(ad,Z){if(ad.toString().indexOf(albumIdPrefix)==0){var aa=ad
}else{var aa=albumIdPrefix+ad}var ac=document.getElementById(aa);if(!ac){return}ac.removeAttribute("style");ac.removeAttribute("opacity");if(Z){var ae=document.createElementNS(F,"animate");ae.setAttribute("id","topAlbumAniOpacity");ae.setAttribute("attributeType","CSS");
ae.setAttribute("attributeName","opacity");ae.setAttribute("from",opacityMaximum);ae.setAttribute("to",albumOpenedOpacity);ae.setAttribute("dur","1s");ae.setAttribute("repeatCount","indefinite");var ab=document.createElementNS(F,"animateMotion");ab.setAttribute("id","topAlbumAniMotion");
ab.setAttribute("path","M 0 0 V 10 V 8 V 5 V 3  V0");ab.setAttribute("fill","freeze");ab.setAttribute("begin","0s");ab.setAttribute("dur","1s");ab.setAttribute("repeatCount","indefinite");ac.appendChild(ae);ac.appendChild(ab)}else{var ae=document.getElementById("topAlbumAniOpacity");
if(ae){ac.removeChild(ae)}var ab=document.getElementById("topAlbumAniMotion");if(ab){ac.removeChild(ab)}}}function j(Z,aa,ae){if(Z&&ae){if(ae.toString().indexOf(albumIdPrefix)==0){var ac=ae}else{var ac=albumIdPrefix+ae}for(var ab=0;ab<albumsOnGallery.length;
ab++){var ad=document.getElementById(albumsOnGallery[ab].id);if(!ad){return}if(albumsOnGallery[ab].id==ac){if(aa){V(ad,imageDefaultOpacity)}else{ad.style.opacity=imageDefaultOpacity}}else{if(aa){V(ad,albumClosedOpacity)}else{ad.style.opacity=albumClosedOpacity
}}}}else{if(Z){for(var ab=0;ab<albumsOnGallery.length;ab++){var ad=document.getElementById(albumsOnGallery[ab].id);if(!ad){return}if(aa){V(ad,albumClosedOpacity)}else{ad.style.opacity=albumClosedOpacity}}}else{for(var ab=0;ab<albumsOnGallery.length;ab++){var ad=document.getElementById(albumsOnGallery[ab].id);
if(!ad){return}if(aa){V(ad,imageDefaultOpacity)}else{ad.style.opacity=imageDefaultOpacity}}}}}function u(aa){var ae=document.getElementById(contextMenuId);if(ae){ae.parentNode.removeChild(ae)}var Z=document.createElementNS(F,"g");Z.setAttribute("id",contextMenuId);
var ac=0,ag=180,ab=23;itPosX=aa.clientX+2,itPosY=aa.clientY+2,itClct=[],itInfo={};var af=aa.target;if(T(af)){itInfo={};itInfo.type="1";itInfo.index=ac++;itInfo.id=contextMenuId+"Item-1-"+itInfo.index;if(topImageOnGallery.id==N(aa)){itInfo.text="关闭查看"}else{itInfo.text="查看原图"
}itInfo.posX=itPosX;itInfo.posY=itPosY+(ab*itInfo.index);itInfo.width=ag;itInfo.height=ab;itInfo.handler=function(ah){return function(){l(ah)}}(N(aa));itClct[itInfo.index]=itInfo;itInfo={};itInfo.type="1";itInfo.index=ac++;itInfo.id=contextMenuId+"Item-1-"+itInfo.index;
itInfo.text="在新窗口打开图片";itInfo.posX=itPosX;itInfo.posY=itPosY+(ab*itInfo.index);itInfo.width=ag;itInfo.height=ab;itInfo.handler=function(ah){return function(){window.open(i(ah).uri)}}(N(aa));itClct[itInfo.index]=itInfo;itInfo={};itInfo.type="1";itInfo.index=ac++;
itInfo.id=contextMenuId+"Item-1-"+itInfo.index;itInfo.text="查看图片信息";itInfo.posX=itPosX;itInfo.posY=itPosY+(ab*itInfo.index);itInfo.width=ag;itInfo.height=ab;itInfo.handler=function(ah){return function(){Y(i(ah).uri)}}(N(aa));itClct[itInfo.index]=itInfo}if(U(af)){itInfo={};
itInfo.type="2";itInfo.index=ac++;itInfo.id=contextMenuId+"Item-2-"+itInfo.index;if(!topAlbumsOnGallery.id||topAlbumsOnGallery.id&&topAlbumsOnGallery.id!=P(N(aa))){itInfo.text="打开相册";itInfo.handler=function(ah){return function(){E();R(ah)}}(N(aa))}else{if(topAlbumsOnGallery.id==P(N(aa))){itInfo.text="关闭相册";
itInfo.handler=function(){E(true);topAlbumsOnGallery={}}}}itInfo.posX=itPosX;itInfo.posY=itPosY+(ab*itInfo.index);itInfo.width=ag;itInfo.height=ab;itClct[itInfo.index]=itInfo}itInfo={};itInfo.type="0";itInfo.index=ac++;itInfo.id=contextMenuId+"Item-0-"+itInfo.index;
itInfo.text="清空画廊";itInfo.posX=itPosX;itInfo.posY=itPosY+(ab*itInfo.index);itInfo.width=ag;itInfo.height=ab;itInfo.handler=function(){E()};itClct[itInfo.index]=itInfo;itInfo={};itInfo.type="0";itInfo.index=ac++;itInfo.id=contextMenuId+"Item-0-"+itInfo.index;
itInfo.text="重新加载";itInfo.posX=itPosX;itInfo.posY=itPosY+(ab*itInfo.index);itInfo.width=ag;itInfo.height=ab;itInfo.handler=function(){var ah=window.top;ah.location.reload()};itClct[itInfo.index]=itInfo;if((itPosX+ag)>galleryViewWidth){for(var ad=0;ad<itClct.length;
ad++){itClct[ad].posX=itPosX-ag}}if((itPosY+ab*itClct.length)>galleryViewHeight){for(var ad=0;ad<itClct.length;ad++){itClct[ad].posY=itPosY-ab*(itClct.length-itClct[ad].index)}}for(var ad=0;ad<itClct.length;ad++){if(ad>0&&itClct[ad].type!=itClct[ad-1].type){Z.appendChild(B(itClct[ad].posX,itClct[ad].posY,itClct[ad].posX+ag,itClct[ad].posY))
}Z.appendChild(L(itClct[ad].index,itClct[ad].id,itClct[ad].text,itClct[ad].posX,itClct[ad].posY,itClct[ad].width,itClct[ad].height,itClct[ad].handler,itClct[ad].link,itClct[ad].target))}document.getElementById(galleryElId).appendChild(Z)}function L(aa,af,ah,ag,ae,Z,aj,al,ad,ab){var ak=document.createElementNS(F,"g");
ak.setAttribute("id",af);ak.addEventListener("mouseover",function(am){return function(){var ap=am;var ao=document.getElementById(ap+"-border");var an=document.getElementById(ap+"-text");if(ao){ao.setAttribute("class","ctxMenuItemHover")}if(an){an.setAttribute("class","ctxMenuItemTextHover")
}}}(af),false);ak.addEventListener("mouseout",function(am){return function(){var ap=am;var ao=document.getElementById(ap+"-border");var an=document.getElementById(ap+"-text");if(ao){ao.setAttribute("class","ctxMenuItem")}if(an){an.setAttribute("class","ctxMenuItemText")
}}}(af),false);if(al){ak.addEventListener("click",al,false)}var ac=document.createElementNS(F,"rect");ac.setAttribute("id",af+"-border");ac.setAttribute("class","ctxMenuItem");A(ac,ag,ae,Z,aj);var ai=document.createElementNS(F,"text");ai.setAttribute("id",af+"-text");
ai.setAttribute("class","ctxMenuItemText");A(ai,ag+5,ae+aj-7,Z,aj);aniM=document.createElementNS(F,"animateMotion");aniM.setAttribute("path","M "+(-(ag+5-Z))+" 0 H 0 0");aniM.setAttribute("fill","freeze");aniM.setAttribute("begin",0.2*aa+"s");aniM.setAttribute("dur","2s");
ai.appendChild(aniM);aniSV=document.createElementNS(F,"animate");aniSV.setAttribute("attributeType","CSS");aniSV.setAttribute("attributeName","opacity");aniSV.setAttribute("from","0.2");aniSV.setAttribute("to",opacityMaximum);aniSV.setAttribute("begin",0.2*aa+"s");
aniSV.setAttribute("dur","2s");ai.appendChild(aniSV);ai.appendChild(document.createTextNode(ah));if(!al&&ad&&ab){itlink=document.createElementNS(F,"a");itlink.setAttribute("xlink:href",ad);itlink.setAttribute("href",ad);itlink.setAttribute("target",ab);itlink.appendChild(ac);
itlink.appendChild(ai);ak.appendChild(itlink)}else{ak.appendChild(ac);ak.appendChild(ai)}return ak}function B(ac,ae,aa,ad){var af=document.createElementNS(F,"line");af.setAttribute("x1",ac);af.setAttribute("y1",ae);af.setAttribute("x2",aa);af.setAttribute("y2",ad);
af.setAttribute("width",2);af.setAttribute("class","ctxDividingLine");var Z=document.createElementNS(F,"animate");Z.setAttribute("attributeType","XML");Z.setAttribute("attributeName","x2");Z.setAttribute("from",ac);Z.setAttribute("to",aa);Z.setAttribute("fill","freeze");
Z.setAttribute("begin","0s");Z.setAttribute("dur","0.5s");af.appendChild(Z);var ab=document.createElementNS(F,"animate");ab.setAttribute("attributeType","XML");ab.setAttribute("attributeName","y2");ab.setAttribute("from",ae);ab.setAttribute("to",ad);ab.setAttribute("fill","freeze");
ab.setAttribute("begin","0s");ab.setAttribute("dur","0.5s");af.appendChild(ab);return af}function T(Z){if(Z.id.indexOf(imageIdPrefix)==0){return true}else{return false}}function U(Z){if(Z.id.indexOf(coverIdPrefix)==0){return true}else{return false}}function z(aa){var ab=document.getElementById(aa);
var Z=document.getElementById(aa+"-overlay");ab.setAttribute("transform","translate("+ab.vTranslate[0]+","+ab.vTranslate[1]+") scale("+ab.vScale+","+ab.vScale+") rotate("+ab.vRotate+") ")}function X(Z,ak,ab,aj,ad,al,ai,ag){var ac,aa;var af,ae;af=Math.floor(al%ak);
ae=Math.floor(al/ak);if(Z==listStyleGrid){ac=aj/2*(2*af+1);aa=ad/2*(2*ae+1)}else{if(Z==listStyleFree){if(ai){ac=100+Math.random()*(ai-100)}else{ac=100+Math.random()*200+((al+1)%3)*250}if(ag){aa=70+Math.random()*(ag-70)}else{aa=100+Math.random()*200+((al+1)/3)*280
}}else{ac=100+Math.random()*300+((al+1)%3)*250;aa=100+Math.random()*300+((al+1)/3)*280}}var ah=((af+1)*(ae+1))>(ak*ab);return{translate:[ac,aa],position:[af,ae],overflow:ah}}function I(Z,aa){galleryViewWidth=Z<galleryMinWidth?galleryMinWidth:Z;galleryViewHeight=aa<galleryMinHeight?galleryMinHeight:aa
}function n(aa,ac){galleryWidth=aa<galleryViewWidth?galleryViewWidth:aa;galleryHeight=ac<galleryViewHeight?galleryViewHeight:ac;var ab=document.getElementById(t);var Z=document.getElementById(galleryElId);if(ab){ab.style.overflow="auto"}if(Z){Z.style.width=galleryWidth
}Z.style.height=galleryHeight;alert("当前采用方格式排列方式，画廊没地儿了啦。")}function s(Z,ab){var aa=imgInitWRange,ac=imgInitHRange;if(galleryViewWidth/galleryMinWidth>1){aa=[imgInitWRange[0]*galleryViewWidth/galleryMinWidth,imgInitWRange[1]*galleryViewWidth/galleryMinWidth]
}if(galleryViewHeight/galleryMinHeight>1){ac=[imgInitHRange[0]*galleryViewHeight/galleryMinHeight,imgInitHRange[1]*galleryViewHeight/galleryMinHeight]}if(Z>aa[0]&&Z<aa[1]){aa[1]=Z}if(Z<=aa[0]){aa[0]=aa[1]=Z}if(ab>ac[0]&&ab<ac[1]){ac[1]=ab}if(ab<=ac[0]){ac[0]=ac[1]=ab
}return{width:aa,height:ac}}function O(aa,ad,ac,ae,ab,af,ag,ah){var Z=document.createElementNS(F,"rect");Z.setAttribute("id",aa);A(Z,ad,ac,ae,ab);Z.setAttribute("rx",30);Z.setAttribute("ry",30);Z.setAttribute("fill",af);Z.addEventListener("mousedown",ah,false);
return Z}function Q(ab,Z,ac){var aa="top-img-background-overlay";if(!ab){var ad=document.getElementById(aa);if(ad){ad.parentNode.removeChild(ad)}return}var ad=document.createElementNS(F,"rect");ad.setAttribute("id",aa);A(ad,0,0,"100%","100%");ad.setAttribute("fill","black");
ad.setAttribute("opacity","0.8");ad.setAttribute("visibility","visible");if(Z&&ac){ad.addEventListener(Z,ac,false)}document.getElementById(galleryElId).appendChild(ad);C(aa)}function H(al,av,an,ad){var ag=N(al);var ae=P(ag);var ar=ae+"-tooltip";var az=ae+"-tooltip-function";
if(document.getElementById(ar)||(!an&&globalCache.tooltip[az])){return}if(!an){globalCache.tooltip[az]={};globalCache.tooltip[az].src=ae;globalCache.tooltip[az].id=ar;globalCache.tooltip[az].func=setTimeout(function(){return function(){H(al,av,true,ad)}}(al,av,true,ad),1022);
return}var aa=document.createElementNS(F,"g");aa.setAttribute("id",ar);var ax=document.getElementById(ag);var ap=document.getElementById(ae);if(ax&&ap&&ax.vTranslate&&ap.vTranslate){var am=ax.vTranslate[0]+ap.vTranslate[0];var aj=ax.vTranslate[1]+ap.vTranslate[1]
}else{var am=al.clientX;var aj=al.clientY}var ao=30,Z=20,af=50,at=20,ay=60,ak=100,ac=10,aw="",ab=[],aq=[];aw=am+","+aj+" "+(am+Z)+","+(aj-ao)+" "+(am+af)+","+(aj-ao);ab=[am-at,aj-ao-ay];aq=[am-at+ac,aj-ao-ac];if((am-ao-ay)<0){}var au=document.createElementNS(F,"polygon");
au.setAttribute("id",ar+"-triangleBg");au.setAttribute("class","tooltipBackground");au.setAttribute("points",aw);aa.appendChild(au);var ah=document.createElementNS(F,"rect");ah.setAttribute("id",ar+"-rectBg");ah.setAttribute("class","tooltipBackground");ah.setAttribute("rx",10);
ah.setAttribute("ry",10);A(ah,ab[0],ab[1],ak,ay);aa.appendChild(ah);var ai=document.createElementNS(F,"text");ai.setAttribute("id",ar+"-text");ai.setAttribute("class","tooltipText");ai.appendChild(document.createTextNode(av));A(ai,aq[0],aq[1],ak,ay);aa.appendChild(ai);
document.getElementById(galleryElId).appendChild(aa);setTimeout(function(){document.getElementById(galleryElId).removeChild(aa)},(ad?ad:3000));delete globalCache[az];C(ar)}function A(ac,Z,ad,aa,ab){ac.setAttribute("x",Z);ac.setAttribute("y",ad);ac.setAttribute("width",aa);
ac.setAttribute("height",ab)}function C(aa){var Z=document.getElementById(aa);Z.parentNode.removeChild(Z);document.getElementById(galleryElId).appendChild(Z)}function V(aa,ac,Z){if(!aa){return}aa.style.opacity=(Z||Z==0)?parseFloat(Z):((aa.style.opacity||aa.style.opacity==0)?parseFloat(aa.style.opacity):1);
var ab=parseFloat(aa.style.opacity);fd=parseFloat(ac);if(ab<fd){K(aa,fd)}else{if(ab>fd){h(aa,fd)}}}function h(aa,Z){if(!aa){return}if(parseFloat(aa.style.opacity)<=parseFloat(Z)){return}aa.removeAttribute("opacity");var ab=function(){var ac=parseFloat(aa.style.opacity)-0.05;
aa.style.opacity=ac;if(ac>parseFloat(Z)){setTimeout(ab,10)}};ab()}function K(aa,Z){if(!aa){return}if(parseFloat(aa.style.opacity)>=parseFloat(Z)){return}aa.removeAttribute("opacity");var ab=function(){var ac=parseFloat(aa.style.opacity)+0.05;aa.style.opacity=ac;
if(ac<parseFloat(Z)){setTimeout(ab,10)}};ab()}function P(Z){if(relationAI&&(Z in relationAI)){return relationAI[Z].parent}return null}function D(ac){if(ac.indexOf(albumIdPrefix)==0){var aa=ac}else{var aa=P(ac)}if(!aa){return}if(!(relationAI[aa]&&(relationAI[aa].id||relationAI[aa].id==0))){return
}var ab;if(!(w instanceof Array)){ab=w}else{for(var Z=0;Z<w.length;Z++){if(w[Z].id==relationAI[aa].id){ab=w[Z];break}}}return ab}function N(Z){var aa=Z.target.getAttribute("id");return aa.substr(0,aa.indexOf("-"))}function Y(aa){var Z=new Image();Z.onload=function(){var ab="该图片的信息如下：\n\n";
ab+="文件:        "+this.src.substr(this.src.lastIndexOf("/")+1,this.src.length)+"图片\n";ab+="类型:        "+this.src.substr(this.src.lastIndexOf(".")+1,this.src.length).toUpperCase()+"图片\n";ab+="大小:        未知\n";ab+="尺寸:        "+this.width+"px × "+this.height+"px\n";
ab+="地址:        "+this.src+"\n\n";ab+="您要在新窗口打开图片吗？";if(confirm(ab)){window.open(this.src)}};Z.src=aa}function f(ac){var ad=/(webkit)[ \/]([\w.]+)/;var ag=/(opera)(?:.*version)?[ \/]([\w.]+)/;var ab=/(msie) ([\w.]+)/;var af=/(mozilla)(?:.*? rv:([\w.]+))?/;var ae=navigator.userAgent;
ae=ae.toLowerCase();var aa=ad.exec(ae)||ag.exec(ae)||ab.exec(ae)||ae.indexOf("compatible")<0&&af.exec(ae)||[];var Z={browser:aa[1]||"",version:aa[2]||"0"};if(Z.browser==ac.toLowerCase()){return Z}else{return false}}return M}(iSvgGallery.data);